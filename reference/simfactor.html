<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate factor structures with misspecification errors. — simfactor • latent</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate factor structures with misspecification errors. — simfactor"><meta name="description" content="Simulate factor and bifactor structures with crossloadings, correlated factors, and more."><meta property="og:description" content="Simulate factor and bifactor structures with crossloadings, correlated factors, and more."></head><body><p>








  inst/pkgdown/includes/custom-head.html

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">latent</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/lca_article.html">The Latent Class model</a></li>
    <li><a class="dropdown-item" href="../articles/cfa_article.html">The Confirmatory Factor model</a></li>
    <li><a class="dropdown-item" href="../articles/efa_article.html">The Exploratory Factor model</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/lca_tutorial.html">Latent Class Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/cfa_tutorial.html">Confirmatory Factor Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/efa_tutorial.html">Exploratory Factor Analysis</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-estimators" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Estimators</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-estimators"><li><a class="dropdown-item" href="../articles/lca_tutorial.html">Likelihoods</a></li>
    <li><a class="dropdown-item" href="../articles/efa_tutorial.html">Loss functions</a></li>
    <li><a class="dropdown-item" href="../articles/efa_tutorial.html">Regularization/Penalties</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-transformations" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Transformations</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-transformations"><li><a class="dropdown-item" href="../articles/lca_tutorial.html">Vectors</a></li>
    <li><a class="dropdown-item" href="../articles/cfa_tutorial.html">Matrices</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-manifolds" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Manifolds</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-manifolds"><li><a class="dropdown-item" href="../articles/lca_tutorial.html">Vectors</a></li>
    <li><a class="dropdown-item" href="../articles/lca_tutorial.html">Matrices</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-optimizers" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Optimizers</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-optimizers"><li><a class="dropdown-item" href="../articles/lca_tutorial.html">First-order</a></li>
    <li><a class="dropdown-item" href="../articles/lca_tutorial.html">Second-order</a></li>
    <li><a class="dropdown-item" href="../articles/cfa_tutorial.html">Step-size selection</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Marcosjnez/latent/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate factor structures with misspecification errors.</h1>
      <small class="dont-index">Source: <a href="https://github.com/Marcosjnez/latent/blob/master/R/simfactor.R" class="external-link"><code>R/simfactor.R</code></a></small>
      <div class="d-none name"><code>simfactor.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulate factor and bifactor structures with crossloadings, correlated factors, and more.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simfactor</span><span class="op">(</span>nfactors <span class="op">=</span> <span class="fl">5</span>, nitems <span class="op">=</span> <span class="fl">6</span>, loadings <span class="op">=</span> <span class="st">"medium"</span>,</span>
<span>crossloadings <span class="op">=</span> <span class="fl">0</span>, correlations <span class="op">=</span> <span class="fl">0</span>,</span>
<span>estimator <span class="op">=</span> <span class="st">"minres"</span>, fit <span class="op">=</span> <span class="st">"rmsr"</span>, misfit <span class="op">=</span> <span class="fl">0</span>,</span>
<span>error_method <span class="op">=</span> <span class="st">"cudeck"</span>, efa <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>ngenerals <span class="op">=</span> <span class="fl">0</span>, loadings_g <span class="op">=</span> <span class="st">"medium"</span>, correlations_g <span class="op">=</span> <span class="fl">0</span>,</span>
<span>pure <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>lambda <span class="op">=</span> <span class="cn">NULL</span>, Phi <span class="op">=</span> <span class="cn">NULL</span>, Psi <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-nfactors">nfactors<a class="anchor" aria-label="anchor" href="#arg-nfactors"></a></dt>
<dd><p>Number of factors.</p></dd>


<dt id="arg-nitems">nitems<a class="anchor" aria-label="anchor" href="#arg-nitems"></a></dt>
<dd><p>Number of items per factor.</p></dd>


<dt id="arg-loadings">loadings<a class="anchor" aria-label="anchor" href="#arg-loadings"></a></dt>
<dd><p>Loadings' magnitude on the factors: "low", "medium" or "high". Defaults to "medium".</p></dd>


<dt id="arg-crossloadings">crossloadings<a class="anchor" aria-label="anchor" href="#arg-crossloadings"></a></dt>
<dd><p>Magnitude of the cross-loadings among the group factors. Defaults to 0.</p></dd>


<dt id="arg-correlations-g">correlations_g<a class="anchor" aria-label="anchor" href="#arg-correlations-g"></a></dt>
<dd><p>Correlation among the general factors. Defaults to 0.</p></dd>


<dt id="arg-correlations">correlations<a class="anchor" aria-label="anchor" href="#arg-correlations"></a></dt>
<dd><p>Correlation among the factors. Defaults to 0.</p></dd>


<dt id="arg-estimator">estimator<a class="anchor" aria-label="anchor" href="#arg-estimator"></a></dt>
<dd><p>estimator used to generate population error: "minres" or "ml".</p></dd>


<dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p>Fit index to control the population error.</p></dd>


<dt id="arg-misfit">misfit<a class="anchor" aria-label="anchor" href="#arg-misfit"></a></dt>
<dd><p>Misfit value to generate population error.</p></dd>


<dt id="arg-error-method">error_method<a class="anchor" aria-label="anchor" href="#arg-error-method"></a></dt>
<dd><p>Method used to control population error: c("yuan", "cudeck"). Defaults to "cudeck".</p></dd>


<dt id="arg-efa">efa<a class="anchor" aria-label="anchor" href="#arg-efa"></a></dt>
<dd><p>Reproduce the error with EFA or CFA. Defaults to FALSE (CFA).</p></dd>


<dt id="arg-ngenerals">ngenerals<a class="anchor" aria-label="anchor" href="#arg-ngenerals"></a></dt>
<dd><p>Number of general factors.</p></dd>


<dt id="arg-loadings-g">loadings_g<a class="anchor" aria-label="anchor" href="#arg-loadings-g"></a></dt>
<dd><p>Loadings' magnitude on the general factors: "low", "medium" or "high". Defaults to "medium".</p></dd>


<dt id="arg-pure">pure<a class="anchor" aria-label="anchor" href="#arg-pure"></a></dt>
<dd><p>Fix a pure item on each general factor. Defaults to FALSE.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Custom loading matrix. If Phi is NULL, then all the factors will be correlated at the value given in correlations.</p></dd>


<dt id="arg-phi">Phi<a class="anchor" aria-label="anchor" href="#arg-phi"></a></dt>
<dd><p>Custom Phi matrix. If lambda is NULL, then Phi should be conformable to the loading matrix specified with the above arguments.</p></dd>


<dt id="arg-psi">Psi<a class="anchor" aria-label="anchor" href="#arg-psi"></a></dt>
<dd><p>Custom Psi matrix.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with the following objects:</p>
<dl><dt>lambda</dt>
<dd><p>Population loading matrix.</p></dd>

<dt>Phi</dt>
<dd><p>Population factor correlation matrix.</p></dd>

<dt>Psi</dt>
<dd><p>Population covariance matrix between the errors.</p></dd>

<dt>R</dt>
<dd><p>Model correlation matrix.</p></dd>

<dt>R_error</dt>
<dd><p>Model correlation matrix with misspecification errors.</p></dd>

<dt>uniquenesses</dt>
<dd><p>Population uniquenesses.</p></dd>

<dt>delta</dt>
<dd><p>Minimum of the loss function that correspond to the misfit value.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>simfactor</code> generates bi-factor and generalized bifactor patterns with cross-loadings, pure items and
correlations among the general and group factors. When <code>crossloading</code> is different than 0, one cross-loading
is introduced for an item pertaining to each group factor. When <code>pure</code> is TRUE, one item loading of each group
factor is removed so that the item loads entirely on the general factor. To maintain the item communalities
constant upon these modifications, the item loading on the other factors may shrunk (if adding cross-loadings)
or increase (if setting pure items).</p>
<p>Loading magnitudes may range between 0.3-0.5 ("low"), 0.4-0.6 ("medium") and 0.5-0.7 ("high"). Custom ranges can be supplied as vectors (i.e., c(0.2, 0.5))</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cudeck, R., &amp; Browne, M. W. (1992). Constructing a covariance matrix that yields a specified minimizer and a specified minimum discrepancy function value. <em>Psychometrika, 57</em>(3), 357–369. <a href="https://doi.org/10.1007/BF02295424" class="external-link">doi:10.1007/BF02295424</a></p>
<p>Jiménez, M., Abad, F. J., Garcia-Garzon, E., &amp; Garrido, L. E. (2023). Exploratory Bi-factor Analysis with Multiple General Factors. <em>Multivariate Behavioral Research, 58</em>(6), 1072–1089. <a href="https://doi.org/10.1080/00273171.2023.2189571" class="external-link">doi:10.1080/00273171.2023.2189571</a></p>
<p>Jiménez, M., Abad, F. J., Garcia-Garzon, E., Golino, H., Christensen, A. P., &amp; Garrido, L. E. (2023). Dimensionality assessment in bifactor structures with multiple general factors: A network psychometrics approach. <em>Psychological Methods</em>. Advance online publication. <a href="https://doi.org/10.1037/met0000590" class="external-link">doi:10.1037/met0000590</a></p>
<p>Yuan, K.-H., &amp; Hayashi, K. (2003). Bootstrap approach to inference and power analysis based on three test statistics for covariance structure models. <em>British Journal of Mathematical and Statistical Psychology, 56</em>(1), 93–110. <a href="https://doi.org/10.1348/000711003321645368" class="external-link">doi:10.1348/000711003321645368</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate data:</span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">simfactor</span><span class="op">(</span>nfactors <span class="op">=</span> <span class="fl">3</span>, nitems <span class="op">=</span> <span class="fl">4</span>, correlations <span class="op">=</span> <span class="fl">0.40</span>,</span></span>
<span class="r-in"><span>                 crossloadings <span class="op">=</span> <span class="fl">0.30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim</span><span class="op">$</span><span class="va">lambda</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               S1        S2        S3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> item1  0.4807076 0.0000000 0.3000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> item2  0.4127323 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> item3  0.4777403 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> item4  0.5951096 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> item5  0.3000000 0.4579785 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> item6  0.0000000 0.5356761 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> item7  0.0000000 0.5470639 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> item8  0.0000000 0.4391913 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> item9  0.0000000 0.3000000 0.5961079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> item10 0.0000000 0.0000000 0.5483043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> item11 0.0000000 0.0000000 0.4102893</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> item12 0.0000000 0.0000000 0.5060425</span>
<span class="r-in"><span><span class="va">sim</span><span class="op">$</span><span class="va">Phi</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.0  0.4  0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.4  1.0  0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.4  0.4  1.0</span>
<span class="r-in"><span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="fl">1e3</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">R_error</span><span class="op">)</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">R_error</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marcos Jiménez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  
</body></html>

