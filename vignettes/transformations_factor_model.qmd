---
title: "Factor Model"
format: html
---

## Transformation

$$
\hat{S}(\theta) = \Lambda \Psi \Lambda^\top + \Theta
$$

## Update of the gradient
      
$$
\Delta_{\Lambda} = 2\Delta_{\hat{S}(\theta)} \Lambda \Psi
$$

$$
\Delta_{\Psi} = \Lambda^\top \Delta_{\hat{S}(\theta)} \Lambda
$$

$$
\Delta_{\Theta} = \Delta_{\hat{S}(\theta)}
$$

## Update of the differential

$$
\partial \Delta_{\hat{S}(\theta)} = \partial \Lambda \Psi \Lambda^\top +
\Lambda \partial \Psi \Lambda^\top +
\Lambda \Psi \partial \Lambda^\top +
\partial \Theta
$$

## Update of the differential of the gradient

$$
\partial \Delta_{\Lambda} = 2\left( \partial \Delta_{\hat{S}(\theta)} \Lambda \Psi + \Delta_{\hat{S}(\theta)} \big(\partial \Lambda \Psi + \Lambda \partial\Psi \big) \right)
$$

$$
\partial \Delta_{\Psi} = \partial \Lambda^\top \Delta_{\hat{S}(\theta)} \Lambda +
\Lambda^\top \partial \Delta_{\hat{S}(\theta)} \Lambda +
\Lambda^\top \Delta_{\hat{S}(\theta)} \partial \Lambda
$$

$$
\partial \Delta_{\Theta} = \partial \Delta_{\hat{S}(\theta)}
$$

## Jacobian

$$
J_\Lambda = \big(\Lambda \Psi \big)^\top \otimes I_p
$$

$$
J_\Psi = \Lambda \otimes \Lambda
$$

$$
J_\Psi = I_{p^2\times p^2}
$$

## Differential of the jacobian towards the gradient

## Constraints 

## Constraints' derivatives

