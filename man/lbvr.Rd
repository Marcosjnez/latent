% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lbvr.R
\name{lbvr}
\alias{lbvr}
\title{Local Bivariate Residuals for Latent Class Analysis}
\usage{
lbvr(model, digits = 4)
}
\arguments{
\item{model}{An object of class `"lca"` from the \pkg{latent} package.}

\item{digits}{Integer; number of decimal places to use in rounding the output
matrices and the summary table. Default is 4.}
}
\value{
A list of class `"lbvr"` with components:
  \item{residual_matrix}{A symmetric matrix of residual measures:
    \itemize{
      \item For continuous–continuous pairs: Pearson correlation of residuals.
      \item For categorical–categorical pairs: maximum absolute standardized residual.
      \item For continuous–categorical pairs: maximum absolute Z‑score of mean residuals per category.
    }}
  \item{pvalue_matrix}{Symmetric matrix of p-values corresponding to the
    residual measures (using correlation test, chi‑square test, or ANOVA F‑test).}
  \item{r_mat}{Symmetric matrix of effect sizes comparable to a correlation:
    \itemize{
      \item Continuous–continuous: Pearson \eqn{r}.
      \item Categorical–categorical: difference of Cramér's V (\eqn{V_{obs} - V_{exp}}).
      \item Continuous–categorical: \eqn{\eta} (square root of eta‑squared from ANOVA).
    }}
  \item{rmsr}{Root mean square of the upper triangle of `r_mat`; a global fit index.}
  \item{res_tab}{A data frame with one row per variable pair, containing:
    \code{pair}, \code{statistic} (the residual measure), \code{p_value},
    \code{r} (the correlation‑like effect size), \code{var_types}, and
    \code{test} (a descriptive label). The table is sorted by absolute \code{r}.}
}
\description{
Computes bivariate residuals (BVR) and related diagnostics for a fitted latent
class model with mixed indicators (continuous and categorical). The function
returns a matrix of residuals, p-values, a correlation-like effect size, and a
summary table. The root mean square residual (RMSR) provides a global fit measure.
}
\details{
The function extracts data, variable types, posterior probabilities, class‑specific
means, and response probabilities from a fitted \pkg{latent} model. It then computes
residuals for each pair of indicators using only pairwise complete observations.
Missing data are handled by scaling expected frequencies to the number of complete
cases for the pair.

For categorical variables, the original data (which may be zero‑based) are
incremented by 1 to ensure proper table construction.
}
\examples{
\dontrun{
library(latent)
# Fit a 3‑class model with multinomial indicators
fit <- lca(data = gss82, nclasses = 3,item = rep("multinomial", ncol(gss82)))
# Compute bivariate residuals
lbvr(fit)
}

}
