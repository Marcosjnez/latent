<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The Latent Class Model â€¢ latent</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="lca_article_files/libs/quarto-html/popper.min.js"></script><script src="lca_article_files/libs/quarto-html/tippy.umd.min.js"></script><link href="lca_article_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lca_article_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The Latent Class Model">
</head>
<body>
<p>








  inst/pkgdown/includes/custom-head.html

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">latent</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/lca_article.html">The Latent Class model</a></li>
    <li><a class="dropdown-item" href="../articles/cfa_article.html">The Confirmatory Factor model</a></li>
    <li><a class="dropdown-item" href="../articles/efa_article.html">The Exploratory Factor model</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/lca_tutorial.html">Latent Class Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/cfa_tutorial.html">Confirmatory Factor Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/efa_tutorial.html">Exploratory Factor Analysis</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-estimators" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Estimators</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-estimators">
<li><a class="dropdown-item" href="../articles/lca_tutorial.html">Likelihoods</a></li>
    <li><a class="dropdown-item" href="../articles/efa_tutorial.html">Loss functions</a></li>
    <li><a class="dropdown-item" href="../articles/efa_tutorial.html">Regularization/Penalties</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-transformations" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Transformations</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-transformations">
<li><a class="dropdown-item" href="../articles/lca_tutorial.html">Vectors</a></li>
    <li><a class="dropdown-item" href="../articles/cfa_tutorial.html">Matrices</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-manifolds" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Manifolds</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-manifolds">
<li><a class="dropdown-item" href="../articles/lca_tutorial.html">Vectors</a></li>
    <li><a class="dropdown-item" href="../articles/lca_tutorial.html">Matrices</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-optimizers" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Optimizers</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-optimizers">
<li><a class="dropdown-item" href="../articles/lca_tutorial.html">First-order</a></li>
    <li><a class="dropdown-item" href="../articles/lca_tutorial.html">Second-order</a></li>
    <li><a class="dropdown-item" href="../articles/cfa_tutorial.html">Step-size selection</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Marcosjnez/latent/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The Latent Class Model</h1>




      <small class="dont-index">Source: <a href="https://github.com/Marcosjnez/latent/blob/master/vignettes/lca_article.qmd" class="external-link"><code>vignettes/lca_article.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="level2"><h2 id="latent-class-analysis">Latent Class Analysis<a class="anchor" aria-label="anchor" href="#latent-class-analysis"></a>
</h2>
<p>Latent Class Analysis assumes that people belong to different groups (i.e., classes) that are due to nonobservable characteristics. In a latent class model, we aim to estimate two kinds of probabilities:</p>
<ol type="1">
<li>The probability that a person belongs to a particular class.</li>
<li>The conditional probabilities of item responses if a person belongs to a given class.</li>
</ol></section><section class="level2"><h2 id="the-likelihood">The likelihood<a class="anchor" aria-label="anchor" href="#the-likelihood"></a>
</h2>
<p>Suppose that a sample of people respond to <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math> items and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ²</mi><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math> is a vector that contains the scores to each item <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>. Let <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math> denote the number of latent classes and let <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>k</mi></msub><annotation encoding="application/x-tex">x_k</annotation></semantics></math> be class <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>. Then, the likelihood of the response pattern <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ²</mi><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math>, if it was observed <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> times in the sample and every person responds independently of each other, can be written as <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â„“</mo><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mi>P</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>n</mi></msup><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo>âˆ£</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mo minsize="3.0" maxsize="3.0" stretchy="false" form="postfix">)</mo><mi>n</mi></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
\ell \;=\; P(\mathbf{y})^{n}
\;=\;
\Bigg(\sum_{k=1}^{K} P(x_k)\, P(\mathbf{y}\mid x_k)\Bigg)^{n}.
</annotation></semantics></math></p>
<p>Assuming <strong>local independence</strong> (responses within a person are independent conditional on class), we have <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo>âˆ£</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
P(\mathbf{y}\mid x_k) \;=\; \prod_{j=1}^{J} P(y_j \mid x_k),
</annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>j</mi></msub><annotation encoding="application/x-tex">y_j</annotation></semantics></math> denotes the score on item <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>. Hence, <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â„“</mo><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mo minsize="3.0" maxsize="3.0" stretchy="false" form="postfix">)</mo><mrow><mspace width="-0.167em"></mspace><mi>n</mi></mrow></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">
\ell \;=\; \Bigg(\sum_{k=1}^{K} P(x_k)\, \prod_{j=1}^{J} P(y_j \mid x_k)\Bigg)^{\!n},
</annotation></semantics></math> and the log-likelihood becomes <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â„“</mo><mo>â„“</mo><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mi>n</mi><mo>log</mo><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="3.0" maxsize="3.0" stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">
\ell\ell \;=\; n \log \Bigg(\sum_{k=1}^{K} P(x_k)\, \prod_{j=1}^{J} P(y_j \mid x_k)\Bigg).
</annotation></semantics></math> The term inside the parenthesis is the probability of a single pattern, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(\mathbf{y})</annotation></semantics></math>. Assuming independence between people with different response patterns, the log-likelihood of the whole sample is the sum of log-likelihoods of each response pattern.</p>
<p>To simplify the computation of the logarithm likelihood and related derivatives, let <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub><mo>=</mo><mo>log</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">l_{y_m \mid x_g} = \log P(y_m \mid x_g)</annotation></semantics></math>, so that</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â„“</mo><mo>â„“</mo><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mi>n</mi><mo>log</mo><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mo>exp</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mo minsize="3.0" maxsize="3.0" stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">
\ell\ell \;=\; n \log \Bigg(\sum_{k=1}^{K} P(x_k)\, \exp\bigg(\sum_{j=1}^{J} l_{y_m \mid x_g}\bigg)\Bigg).
</annotation></semantics></math></p>
</section><section class="level2"><h2 id="first-order-derivatives">First-order derivatives<a class="anchor" aria-label="anchor" href="#first-order-derivatives"></a>
</h2>
<p>For a fixed pattern <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ²</mi><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math>, define <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mspace width="0.278em"></mspace><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mspace width="0.278em"></mspace><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mo>exp</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
P(\mathbf{y}) \;&amp;=\; \sum_{k=1}^{K} P(x_k)\, \prod_{j=1}^{J} P(y_j \mid x_k) \\
&amp;=\; \sum_{k=1}^{K} P(x_k)\, \exp\bigg(\sum_{j=1}^{J} l_{y_m \mid x_g}\bigg).
\end{aligned}
</annotation></semantics></math> Then <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>âˆ‚</mi><mo>â„“</mo><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mi>n</mi><mspace width="0.167em"></mspace><mfrac><mn>1</mn><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mspace width="0.167em"></mspace><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\frac{\partial \ell\ell}{\partial P(x_g)} \;=\; n \,\frac{1}{P(\mathbf{y})}\, \prod_{j=1}^{J} P(y_j \mid x_g).
</annotation></semantics></math> For a specific item <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math> and class <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>, <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>âˆ‚</mi><mo>â„“</mo><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub></mrow></mfrac><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mi>n</mi><mspace width="0.167em"></mspace><mfrac><mn>1</mn><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mspace width="0.167em"></mspace><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\frac{\partial \ell\ell}{\partial l_{y_m \mid x_g}}
\;=\;
n \,\frac{1}{P(\mathbf{y})}\,
P(x_g)\, \prod_{j=1}^{J} P(y_j \mid x_g).
</annotation></semantics></math></p>
<p>Notice that this last expression is just the posterior, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo>âˆ£</mo><msub><mi>y</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(x_g \mid y_m)</annotation></semantics></math>, weighted by <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>.</p>
</section><section class="level2"><h2 id="directional-derivatives-of-first-order-derivatives">Directional derivatives of first-order derivatives<a class="anchor" aria-label="anchor" href="#directional-derivatives-of-first-order-derivatives"></a>
</h2>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">[</mo><mfrac><mrow><mi>âˆ‚</mi><mo>â„“</mo><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo minsize="3.0" maxsize="3.0" stretchy="false" form="postfix">]</mo><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mi>n</mi><mspace width="0.167em"></mspace><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mi>d</mi><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mo>âˆ’</mo><mi>d</mi><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mspace width="0.278em"></mspace><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
d \Bigg[ \frac{\partial \ell\ell}{\partial P(x_g)} \Bigg] \;=\; n \,\frac{P(\mathbf{y}) \; d\big[\prod_{j=1}^{J} P(y_j \mid x_g)\big] - d\big[P(\mathbf{y})\big] \; \prod_{j=1}^{J} P(y_j \mid x_g)}{P(\mathbf{y})^2},
</annotation></semantics></math> where</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mo>=</mo><mfrac><mrow><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
d\big[\prod_{j=1}^{J} P(y_j \mid x_g)\big] = \frac{\prod_{j=1}^{J} P(y_j \mid x_g)}{P(y_j \mid x_g) \, d\big[P(y_j \mid x_g)\big]},
</annotation></semantics></math> and</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>d</mi><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">]</mo><mspace width="0.167em"></mspace><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">]</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">
d\big[P(\mathbf{y})\big] = \sum_{k=1}^{K} d\big[P(x_k)] \, \prod_{j=1}^{J} P(y_j \mid x_k) +
\sum_{k=1}^{K} P(x_k) \, d\big[\prod_{j=1}^{J} P(y_j \mid x_k)].
</annotation></semantics></math></p>
</section><section class="level2"><h2 id="second-order-derivatives">Second-order derivatives<a class="anchor" aria-label="anchor" href="#second-order-derivatives"></a>
</h2>
<p>For classes <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>,</mo><mi>h</mi></mrow><annotation encoding="application/x-tex">g,h</annotation></semantics></math>, <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><mo>â„“</mo><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>âˆ‚</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>h</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mspace width="0.278em"></mspace></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mspace width="0.278em"></mspace><mo>âˆ’</mo><mspace width="0.167em"></mspace><mi>n</mi><mspace width="0.167em"></mspace><mfrac><mn>1</mn><mrow><mi>P</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ²</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></mfrac><mspace width="0.167em"></mspace><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">(</mo><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="3.0" maxsize="3.0" stretchy="false" form="postfix">)</mo><mspace width="-0.167em"></mspace><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">(</mo><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>h</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="3.0" maxsize="3.0" stretchy="false" form="postfix">)</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mspace width="0.278em"></mspace><mo>âˆ’</mo><mi>n</mi><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo>âˆ£</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>h</mi></msub><mo>âˆ£</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>h</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\frac{\partial^2 \ell\ell}{\partial P(x_g)\,\partial P(x_h)} \;&amp;=\; -\,n \,\frac{1}{P(\mathbf{y})^{2}} \,
\Bigg(\prod_{j=1}^{J} P(y_j \mid x_g)\Bigg)\!
\Bigg(\prod_{j=1}^{J} P(y_j \mid x_h)\Bigg) \\
&amp;=\; -n \frac{P(x_g \mid y) P(x_h \mid y)}{P(x_g) P(x_h)}.
\end{aligned}
</annotation></semantics></math></p>
<p>For items <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m,n</annotation></semantics></math> and classes <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>,</mo><mi>h</mi></mrow><annotation encoding="application/x-tex">g,h</annotation></semantics></math>, <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><mo>â„“</mo><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub><mspace width="0.167em"></mspace><mi>âˆ‚</mi><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>n</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>h</mi></msub></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mspace width="0.167em"></mspace><mi>n</mi><mspace width="0.167em"></mspace><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo>âˆ£</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="-0.167em"></mspace><mspace width="0.222em"></mspace><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo>âˆ£</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mspace width="-0.167em"></mspace><mspace width="0.222em"></mspace><mi>g</mi><mo>=</mo><mi>h</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mi>âˆ’</mi><mspace width="0.167em"></mspace><mi>n</mi><mspace width="0.167em"></mspace><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo>âˆ£</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="-0.167em"></mspace><mspace width="0.222em"></mspace><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>h</mi></msub><mo>âˆ£</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise.</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\frac{\partial^2 \ell\ell}{\partial l_{y_m \mid x_g}\,\partial l_{y_n \mid x_h}}
=
\begin{cases}
\,n \, P(x_g \mid y) \!\ \big(1-P(x_g \mid y)\big),
&amp; \text{if } \!\ g=h,\\[1.25em]
-\,n \, P(x_g \mid y) \!\ P(x_h \mid y),
&amp; \text{otherwise.}
\end{cases}
</annotation></semantics></math></p>
<p>For the mixed second derivative, <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><mo>â„“</mo><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>h</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>âˆ‚</mi><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mfrac><mn>1</mn><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mspace width="0.167em"></mspace><mi>n</mi><mspace width="0.167em"></mspace><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo>âˆ£</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo>âˆ£</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>g</mi><mo>=</mo><mi>h</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mi>âˆ’</mi><mspace width="0.167em"></mspace><mfrac><mn>1</mn><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>h</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mspace width="0.167em"></mspace><mi>n</mi><mspace width="0.167em"></mspace><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo>âˆ£</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>h</mi></msub><mo>âˆ£</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise.</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\frac{\partial^2 \ell\ell}{\partial P(x_h)\,\partial l_{y_m \mid x_g}}
=
\begin{cases}
\frac{1}{P(x_g)} \, n \, P(x_g \mid y) \big(1-P(x_g \mid y)\big),
&amp; \text{if } g=h,\\[1.0em]
-\, \frac{1}{P(x_h)} \, n \, P(x_g \mid y) P(x_h \mid y),
&amp; \text{otherwise.}
\end{cases}
</annotation></semantics></math></p>
<p>Collecting these terms gives the Hessian in block form: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">H</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mo>â„“</mo><mo>â„“</mo><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><mo>â„“</mo><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>âˆ‚</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>h</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="center" style="text-align: center"><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><mo>â„“</mo><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>h</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>âˆ‚</mi><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><mo>â„“</mo><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub><mspace width="0.167em"></mspace><mi>âˆ‚</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>h</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="center" style="text-align: center"><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><mo>â„“</mo><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub><mspace width="0.167em"></mspace><mi>âˆ‚</mi><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub></mrow></mfrac></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mspace width="-0.167em"></mspace><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathrm{Hess}(\ell\ell) \;=\;
\begin{bmatrix}
\displaystyle \frac{\partial^2 \ell\ell}{\partial P(x_g)\,\partial P(x_h)} &amp;
\displaystyle \frac{\partial^2 \ell\ell}{\partial P(x_h)\,\partial l_{y_m \mid x_g}} \\[0.8em]
\displaystyle \frac{\partial^2 \ell\ell}{\partial l_{y_m \mid x_g}\,\partial P(x_h)} &amp;
\displaystyle \frac{\partial^2 \ell\ell}{\partial l_{y_m \mid x_g}\,\partial l_{y_m \mid x_g}}
\end{bmatrix}\!.
</annotation></semantics></math></p>
</section><section class="level2"><h2 id="models-for-the-conditional-likelihoods">Models for the conditional likelihoods<a class="anchor" aria-label="anchor" href="#models-for-the-conditional-likelihoods"></a>
</h2>
<p>The conditional probabilities need to be parameterized with a likelihood. We consider a <strong>multinomial</strong> likelihood for categorical items and a <strong>Gaussian</strong> likelihood for continuous items.</p>
<section class="level3"><h3 id="multinomial">Multinomial<a class="anchor" aria-label="anchor" href="#multinomial"></a>
</h3>
<p>For categorical items, let <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ï€</mi><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\pi_{m_k \mid g}</annotation></semantics></math> be the probability of scoring category <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> on item <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math> if a subject belongs to class <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>. Then <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><msub><mi>Ï€</mi><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
P(y_m \mid x_g) \;=\; \pi_{m_k \mid g},
</annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> is such that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">y_m = k</annotation></semantics></math>. With this parameterization, <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>âˆ‚</mi><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Ï€</mi><mrow><msub><mi>n</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mfrac><mn>1</mn><msub><mi>Ï€</mi><mrow><msub><mi>n</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>h</mi></mrow></msub></mfrac><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>y</mi><mi>m</mi></msub><mo>=</mo><mi>k</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>m</mi><mo>=</mo><mi>n</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>g</mi><mo>=</mo><mi>h</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise.</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\frac{\partial l_{y_m \mid x_g}}{\partial \pi_{n_k \mid h}}
=
\begin{cases}
\frac{1}{\pi_{n_k \mid h}}, &amp; \text{if } y_m = k,\ m=n,\ g=h,\\
0, &amp; \text{otherwise.}
\end{cases}
</annotation></semantics></math> and <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Ï€</mi><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow></msub><mi>âˆ‚</mi><msub><mi>Ï€</mi><mrow><msub><mi>n</mi><mi>l</mi></msub><mo>âˆ£</mo><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mi>âˆ’</mi><mfrac><mn>1</mn><msubsup><mi>Ï€</mi><mrow><msub><mi>m</mi><mi>j</mi></msub><mo>âˆ£</mo><mi>i</mi></mrow><mn>2</mn></msubsup></mfrac><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>y</mi><mi>j</mi></msub><mo>=</mo><mi>k</mi><mo>=</mo><mi>l</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>y</mi><mo>=</mo><mi>m</mi><mo>=</mo><mi>n</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>i</mi><mo>=</mo><mi>g</mi><mo>=</mo><mi>h</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise.</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\frac{\partial^2 l_{y_j \mid x_i}}{\partial \pi_{m_k \mid g} \partial \pi_{n_l \mid h}} =
\begin{cases}
-\frac{1}{\pi_{m_j \mid i}^2}, &amp; \text{if } y_j = k = l,\ y=m=n,\ i=g=h,\\
0, &amp; \text{otherwise.}
\end{cases}
</annotation></semantics></math></p>
<p>Consequently, the Hessian for each conditional parameter has the following block form: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">H</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mi>ğ</mi><mspace width="0.278em"></mspace><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Ï€</mi><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow></msub><mi>âˆ‚</mi><msub><mi>Ï€</mi><mrow><msub><mi>n</mi><mi>l</mi></msub><mo>âˆ£</mo><mi>h</mi></mrow></msub></mrow></mfrac><mspace width="0.278em"></mspace><msup><mi>ğ</mi><mi>âŠ¤</mi></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathrm{Hess}(l_{y_m \mid x_g}) \;=\;
\mathbf{e} \; \displaystyle \frac{\partial^2 l_{y_j \mid x_i}}{\partial \pi_{m_k \mid g} \partial \pi_{n_l \mid h}} \; \mathbf{e}^\top,
</annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ</mi><annotation encoding="application/x-tex">\mathbf{e}</annotation></semantics></math> is a vector of zeroes with a 1 in the position corresponding to the parameter <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ï€</mi><mrow><msub><mi>y</mi><mi>j</mi></msub><mo>âˆ£</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\pi_{y_j \mid i}</annotation></semantics></math>.</p>
<p>Notice that each conditional parameter <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub><annotation encoding="application/x-tex">l_{y_m \mid x_g}</annotation></semantics></math> has a Hessian matrix.</p>
</section><section class="level3"><h3 id="gaussian">Gaussian<a class="anchor" aria-label="anchor" href="#gaussian"></a>
</h3>
<p>For continuous items, let <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Ï†</mi><annotation encoding="application/x-tex">\varphi</annotation></semantics></math> denote the normal density. Let <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î¼</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\mu_{m\mid g}</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\sigma_{m\mid g}</annotation></semantics></math> be the mean and standard deviation for item <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math> in class <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>. Then <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mi>Ï†</mi><mspace width="-0.167em"></mspace><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msub><mi>y</mi><mi>m</mi></msub><mo>;</mo><mspace width="0.167em"></mspace><msub><mi>Î¼</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo>,</mo><mspace width="0.167em"></mspace><msub><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">
P(y_m \mid x_g) \;=\; \varphi\!\big(y_m;\, \mu_{m\mid g},\, \sigma_{m\mid g}\big).
</annotation></semantics></math></p>
<p>First derivatives: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>âˆ‚</mi><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Î¼</mi><mrow><mi>n</mi><mo>âˆ£</mo><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mfrac displaystyle="true"><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ’</mo><msub><mi>Î¼</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub></mrow><msubsup><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>2</mn></msubsup></mfrac><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>m</mi><mo>=</mo><mi>n</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>g</mi><mo>=</mo><mi>h</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise,</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\frac{\partial l_{y_m \mid x_g}}{\partial \mu_{n\mid h}}
=
\begin{cases}
\dfrac{y_m - \mu_{m\mid g}}{\sigma_{m\mid g}^{2}}, &amp; \text{if } m=n,\ g=h,\\[0.6em]
0, &amp; \text{otherwise,}
\end{cases}
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>âˆ‚</mi><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Ïƒ</mi><mrow><mi>n</mi><mo>âˆ£</mo><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mfrac displaystyle="true"><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ’</mo><msub><mi>Î¼</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>âˆ’</mo><msubsup><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>2</mn></msubsup></mrow><msubsup><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>3</mn></msubsup></mfrac><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>m</mi><mo>=</mo><mi>n</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>g</mi><mo>=</mo><mi>h</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise.</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\frac{\partial l_{y_m \mid x_g}}{\partial \sigma_{n\mid h}}
=
\begin{cases}
\dfrac{(y_m-\mu_{m\mid g})^{2}-\sigma_{m\mid g}^{2}}{\sigma_{m\mid g}^{3}}, &amp; \text{if } m=n,\ g=h,\\[0.6em]
0, &amp; \text{otherwise.}
\end{cases}
</annotation></semantics></math></p>
<p>Second-order derivatives: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Î¼</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mspace width="0.167em"></mspace><mi>âˆ‚</mi><msub><mi>Î¼</mi><mrow><mi>n</mi><mo>âˆ£</mo><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mi>âˆ’</mi><mfrac displaystyle="true"><mn>1</mn><msubsup><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>2</mn></msubsup></mfrac><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>m</mi><mo>=</mo><mi>n</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>g</mi><mo>=</mo><mi>h</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise,</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\frac{\partial^{2} l_{y_m \mid x_g}}{\partial \mu_{m\mid g}\, \partial \mu_{n\mid h}}
=
\begin{cases}
-\dfrac{1}{\sigma_{m\mid g}^{2}}, &amp; \text{if } m=n,\ g=h,\\[0.6em]
0, &amp; \text{otherwise,}
\end{cases}
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mspace width="0.167em"></mspace><mi>âˆ‚</mi><msub><mi>Ïƒ</mi><mrow><mi>n</mi><mo>âˆ£</mo><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mfrac displaystyle="true"><mn>1</mn><msubsup><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>2</mn></msubsup></mfrac><mo>âˆ’</mo><mfrac displaystyle="true"><mrow><mn>3</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ’</mo><msub><mi>Î¼</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><msubsup><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>4</mn></msubsup></mfrac><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>m</mi><mo>=</mo><mi>n</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>g</mi><mo>=</mo><mi>h</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise,</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\frac{\partial^{2} l_{y_m \mid x_g}}{\partial \sigma_{m\mid g}\, \partial \sigma_{n\mid h}}
=
\begin{cases}
\dfrac{1}{\sigma_{m\mid g}^{2}} - \dfrac{3(y_m-\mu_{m\mid g})^{2}}{\sigma_{m\mid g}^{4}}, &amp; \text{if } m=n,\ g=h,\\[1.0em]
0, &amp; \text{otherwise,}
\end{cases}
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Î¼</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mspace width="0.167em"></mspace><mi>âˆ‚</mi><msub><mi>Ïƒ</mi><mrow><mi>n</mi><mo>âˆ£</mo><mi>h</mi></mrow></msub></mrow></mfrac><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mi>âˆ’</mi><mfrac displaystyle="true"><mrow><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ’</mo><msub><mi>Î¼</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msubsup><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>3</mn></msubsup></mfrac><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>m</mi><mo>=</mo><mi>n</mi><mo>,</mo><mspace width="0.222em"></mspace><mi>g</mi><mo>=</mo><mi>h</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise.</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\frac{\partial^{2} l_{y_m \mid x_g}}{\partial \mu_{m\mid g}\, \partial \sigma_{n\mid h}}
=
\begin{cases}
-\dfrac{2(y_m-\mu_{m\mid g})}{\sigma_{m\mid g}^{3}}, &amp; \text{if } m=n,\ g=h,\\[0.6em]
0, &amp; \text{otherwise.}
\end{cases}
</annotation></semantics></math></p>
<p>Consequently, the Hessian for each conditional parameter has the following block form: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">H</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Î¼</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mspace width="0.167em"></mspace><mi>âˆ‚</mi><msub><mi>Î¼</mi><mrow><mi>n</mi><mo>âˆ£</mo><mi>h</mi></mrow></msub></mrow></mfrac></mtd><mtd columnalign="center" style="text-align: center"><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Î¼</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mspace width="0.167em"></mspace><mi>âˆ‚</mi><msub><mi>Ïƒ</mi><mrow><mi>n</mi><mo>âˆ£</mo><mi>h</mi></mrow></msub></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Ïƒ</mi><mrow><mi>n</mi><mo>âˆ£</mo><mi>h</mi></mrow></msub><mspace width="0.167em"></mspace><mi>âˆ‚</mi><msub><mi>Î¼</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub></mrow></mfrac></mtd><mtd columnalign="center" style="text-align: center"><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mspace width="0.167em"></mspace><mi>âˆ‚</mi><msub><mi>Ïƒ</mi><mrow><mi>n</mi><mo>âˆ£</mo><mi>h</mi></mrow></msub></mrow></mfrac></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\mathrm{Hess}(l_{y_m \mid x_g}) \;=\;
\begin{bmatrix}
\displaystyle \frac{\partial^{2} l_{y_m \mid x_g}}{\partial \mu_{m \mid g}\,\partial \mu_{n \mid h}} &amp; \displaystyle \frac{\partial^{2} l_{y_m \mid x_g}}{\partial \mu_{m \mid g}\,\partial \sigma_{n \mid h}} \\[0.6em]
\displaystyle \frac{\partial^{2} l_{y_m \mid x_g}}{\partial \sigma_{n \mid h}\,\partial \mu_{m \mid g}} &amp; \displaystyle \frac{\partial^{2} l_{y_m \mid x_g}}{\partial \sigma_{m \mid g}\,\partial \sigma_{n \mid h}}
\end{bmatrix}.
</annotation></semantics></math></p>
<p>Notice that each conditional parameter <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>l</mi><mrow><msub><mi>y</mi><mi>m</mi></msub><mo>âˆ£</mo><msub><mi>x</mi><mi>g</mi></msub></mrow></msub><annotation encoding="application/x-tex">l_{y_m \mid x_g}</annotation></semantics></math> has a Hessian matrix.</p>
</section></section><section class="level2"><h2 id="model-for-the-latent-class-probabilities">Model for the latent class probabilities<a class="anchor" aria-label="anchor" href="#model-for-the-latent-class-probabilities"></a>
</h2>
<p>Probabilities of class membership are parameterized with the softmax transformation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¸</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munder><mo>âˆ‘</mo><mi>j</mi></munder><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¸</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
P(x_g) = \frac{\exp(\theta_g)}{\sum_j \exp(\theta_j)},
</annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î¸</mi><mi>g</mi></msub><annotation encoding="application/x-tex">\theta_g</annotation></semantics></math> is the log-scale parameter associated with class <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>.</p>
<p>The jacobian of this transformation is given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>=</mo><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>P</mi><msup><mi>P</mi><mi>âŠ¤</mi></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
J = \mathrm{diag}(P) - PP^\top.
</annotation></semantics></math> Finally, the Hessian for each probability is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">H</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>g</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>e</mi><mi>g</mi></msub><mo>âˆ’</mo><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>e</mi><mi>g</mi></msub><mo>âˆ’</mo><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>âŠ¤</mi></msup><mo>âˆ’</mo><mi>J</mi><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathrm{Hess}\big(P(x_g)\big) \;=\; P(x_g)\bigg((e_gâˆ’P)(e_gâˆ’P)^\topâˆ’J\bigg),
</annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mi>g</mi></msub><annotation encoding="application/x-tex">e_g</annotation></semantics></math> is a vector of zeroes with a <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math> in position <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>.</p>
</section><section class="level2"><h2 id="model-for-the-conditional-probabilities-of-the-multinomial-model">Model for the conditional probabilities of the multinomial model<a class="anchor" aria-label="anchor" href="#model-for-the-conditional-probabilities-of-the-multinomial-model"></a>
</h2>
<p>Probabilities of conditional responses are parameterized with the softmax transformation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ï€</mi><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo>=</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î·</mi><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munder><mo>âˆ‘</mo><mi>j</mi></munder><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î·</mi><mrow><msub><mi>m</mi><mi>j</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
\pi_{m_k \mid g} = \frac{\exp(\eta_{m_k \mid g})}{\sum_j \exp(\eta_{m_j \mid g})},
</annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î·</mi><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">\eta_{m_k \mid g}</annotation></semantics></math> is the log-scale parameter associated with response <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> to item <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math> in class <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>.</p>
<p>The jacobian of this transformation is given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>J</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo>=</mo><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Ï€</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><msub><mi>Ï€</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Ï€</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>âŠ¤</mi></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
J_{m \mid g} = \mathrm{diag}(\pi_{m \mid g}) - \pi_{m \mid g} (\pi_{m \mid g})^\top.
</annotation></semantics></math> Finally, the Hessian for each probability is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">H</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msub><mi>Ï€</mi><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><msub><mi>Ï€</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>e</mi><mi>k</mi></msub><mo>âˆ’</mo><msub><mi>Ï€</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>e</mi><mi>k</mi></msub><mo>âˆ’</mo><msub><mi>Ï€</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>âŠ¤</mi></msup><mo>âˆ’</mo><mi>J</mi><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">
\mathrm{Hess}\big( \pi_{m_k \mid g} \big) \;=\; \pi_{m \mid g}\bigg((e_kâˆ’\pi_{m \mid g})(e_kâˆ’\pi_{m \mid g})^\topâˆ’J\bigg),
</annotation></semantics></math> where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mi>k</mi></msub><annotation encoding="application/x-tex">e_k</annotation></semantics></math> is a vector of zeroes with a <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math> in position <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</p>
</section><section class="level2"><h2 id="constant-priors">Constant priors<a class="anchor" aria-label="anchor" href="#constant-priors"></a>
</h2>
<section class="level3"><h3 id="for-latent-class-probabilities">For latent class probabilities<a class="anchor" aria-label="anchor" href="#for-latent-class-probabilities"></a>
</h3>
</section><section class="level3"><h3 id="for-conditional-likelihoods">For conditional likelihoods<a class="anchor" aria-label="anchor" href="#for-conditional-likelihoods"></a>
</h3>
<section class="level4"><h4 id="multinomial-1">Multinomial<a class="anchor" aria-label="anchor" href="#multinomial-1"></a>
</h4>
<p>For the conditional probabilities modeled with a multinomial likelihood, we add the following term to the log-likelihood for each class <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î»</mi><mn>2</mn></msub><mo>=</mo><munder><mo>âˆ‘</mo><mi>m</mi></munder><munder><mo>âˆ‘</mo><mi>k</mi></munder><msub><mover><mi>Ï€</mi><mo accent="true">Ì‚</mo></mover><msub><mi>m</mi><mi>k</mi></msub></msub><munder><mo>âˆ‘</mo><mi>g</mi></munder><mfrac><mi>Î±</mi><mi>K</mi></mfrac><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Ï€</mi><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\lambda_2 = \sum_m \sum_k \hat{\pi}_{m_k} \sum_g \frac{\alpha}{K} \log (\pi_{m_k \mid g}),
</annotation></semantics></math></p>
<p>Where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Ï€</mi><mo accent="true">Ì‚</mo></mover><msub><mi>m</mi><mi>k</mi></msub></msub><annotation encoding="application/x-tex">\hat{\pi}_{m_k}</annotation></semantics></math> is the proportion of times category <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> was selected in item <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>.</p>
<p>The first-order derivatives are</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>âˆ‚</mi><msub><mi>Î»</mi><mn>2</mn></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Ï€</mi><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow></msub></mrow></mfrac><mo>=</mo><munder><mo>âˆ‘</mo><mi>m</mi></munder><munder><mo>âˆ‘</mo><mi>k</mi></munder><msub><mover><mi>Ï€</mi><mo accent="true">Ì‚</mo></mover><msub><mi>m</mi><mi>k</mi></msub></msub><munder><mo>âˆ‘</mo><mi>g</mi></munder><mfrac><mi>Î±</mi><mi>K</mi></mfrac><mfrac><mn>1</mn><msub><mi>Ï€</mi><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow></msub></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\frac{\partial \lambda_2}{\partial \pi_{m_k \mid g}} = \sum_m \sum_k \hat{\pi}_{m_k} \sum_g \frac{\alpha}{K} \frac{1}{\pi_{m_k \mid g}}.
</annotation></semantics></math></p>
<p>The second-order derivatives are</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><msub><mi>Î»</mi><mn>2</mn></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Ï€</mi><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow></msub><mspace width="0.278em"></mspace><mi>âˆ‚</mi><msub><mi>Ï€</mi><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow></msub></mrow></mfrac><mo>=</mo><mi>âˆ’</mi><munder><mo>âˆ‘</mo><mi>m</mi></munder><munder><mo>âˆ‘</mo><mi>k</mi></munder><msub><mover><mi>Ï€</mi><mo accent="true">Ì‚</mo></mover><msub><mi>m</mi><mi>k</mi></msub></msub><munder><mo>âˆ‘</mo><mi>g</mi></munder><mfrac><mi>Î±</mi><mi>K</mi></mfrac><mfrac><mn>1</mn><msubsup><mi>Ï€</mi><mrow><msub><mi>m</mi><mi>k</mi></msub><mo>âˆ£</mo><mi>g</mi></mrow><mn>2</mn></msubsup></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
\frac{\partial^2 \lambda_2}{\partial \pi_{m_k \mid g} \; \partial \pi_{m_k \mid g}} = -\sum_m \sum_k \hat{\pi}_{m_k} \sum_g \frac{\alpha}{K} \frac{1}{\pi^2_{m_k \mid g}}.
</annotation></semantics></math></p>
</section><section class="level4"><h4 id="gaussian-1">Gaussian<a class="anchor" aria-label="anchor" href="#gaussian-1"></a>
</h4>
<p>For the conditional probabilities modeled with a gaussian likelihood, we add the following term to the log-likelihood for each class <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>Î»</mi><mn>3</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>âˆ‘</mo><mi>g</mi><mi>K</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mi>âˆ’</mi><mn>0.5</mn><mfrac><mi>Î±</mi><mi>K</mi></mfrac><mo>log</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munder><mo>âˆ</mo><mi>j</mi></munder><msubsup><mi>Ïƒ</mi><mrow><mi>j</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>2</mn></msubsup><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mo>âˆ’</mo><mn>0.5</mn><mfrac><mi>Î±</mi><mi>K</mi></mfrac><munder><mo>âˆ‘</mo><mi>j</mi></munder><mfrac><msubsup><mover><mi>Ïƒ</mi><mo accent="true">Ì‚</mo></mover><mi>j</mi><mn>2</mn></msubsup><msubsup><mi>Ïƒ</mi><mrow><mi>j</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>2</mn></msubsup></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>âˆ‘</mo><mi>g</mi><mi>K</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mi>âˆ’</mi><mfrac><mi>Î±</mi><mi>K</mi></mfrac><munder><mo>âˆ‘</mo><mi>j</mi></munder><msub><mi>s</mi><mrow><mi>j</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mo>âˆ’</mo><mn>0.5</mn><mfrac><mi>Î±</mi><mi>K</mi></mfrac><munder><mo>âˆ‘</mo><mi>j</mi></munder><mfrac><msubsup><mover><mi>Ïƒ</mi><mo accent="true">Ì‚</mo></mover><mi>j</mi><mn>2</mn></msubsup><msubsup><mi>Ïƒ</mi><mrow><mi>j</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>2</mn></msubsup></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\lambda_3 &amp;= \sum_g^K \left( -0.5\frac{\alpha}{K} \log\bigg(\prod_j \sigma^2_{j\mid g}\bigg) - 0.5\frac{\alpha}{K} \sum_j \frac{\hat{\sigma}^2_j}{\sigma^2_{j \mid g}} \right) \\
&amp;= \sum_g^K \left( -\frac{\alpha}{K} \sum_j s_{j\mid g} - 0.5\frac{\alpha}{K} \sum_j \frac{\hat{\sigma}^2_j}{\sigma^2_{j \mid g}} \right),
\end{aligned}
</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mover><mi>Ïƒ</mi><mo accent="true">Ì‚</mo></mover><mi>j</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\hat{\sigma}^2_j</annotation></semantics></math> is the variance of item <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.</p>
<p>The first-order derivatives are <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>âˆ‚</mi><msub><mi>Î»</mi><mn>3</mn></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub></mrow></mfrac><mspace width="0.278em"></mspace></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mspace width="0.278em"></mspace><munderover><mo>âˆ‘</mo><mi>g</mi><mi>K</mi></munderover><mo>âˆ’</mo><mfrac><mi>Î±</mi><mrow><mi>K</mi><msub><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub></mrow></mfrac><mo>+</mo><mfrac><mi>Î±</mi><mrow><mi>K</mi><msubsup><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>3</mn></msubsup></mrow></mfrac><msubsup><mover><mi>Ïƒ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>2</mn></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>âˆ‘</mo><mi>g</mi><mi>K</mi></munderover><mfrac><mi>Î±</mi><mi>K</mi></mfrac><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">(</mo><mfrac><msubsup><mover><mi>Ïƒ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>2</mn></msubsup><msubsup><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>3</mn></msubsup></mfrac><mo>âˆ’</mo><mfrac><mn>1</mn><msub><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub></mfrac><mo minsize="3.0" maxsize="3.0" stretchy="false" form="postfix">)</mo><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\frac{\partial \lambda_3}{\partial \sigma_{m \mid g}} \;&amp;=\; \sum_g^K -\frac{\alpha}{K \sigma_{m \mid g}} + \frac{\alpha}{K \sigma^3_{m \mid g}} \hat{\sigma}^2_{m \mid g}\\
&amp;= \sum_g^K \frac{\alpha}{K} \Bigg(\frac{\hat{\sigma}^2_{m \mid g}}{\sigma^3_{m \mid g}} - \frac{1}{\sigma_{m \mid g}}\Bigg).
\end{aligned}
</annotation></semantics></math></p>
<p>The second-order derivatives are <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><msub><mi>Î»</mi><mn>3</mn></msub></mrow><mrow><mi>âˆ‚</mi><msub><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub><mi>âˆ‚</mi><msub><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub></mrow></mfrac><mspace width="0.278em"></mspace><mo>=</mo><mspace width="0.278em"></mspace><munderover><mo>âˆ‘</mo><mi>g</mi><mi>K</mi></munderover><mfrac><mi>Î±</mi><mi>K</mi></mfrac><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">(</mo><mfrac><mn>1</mn><msub><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow></msub></mfrac><mo>âˆ’</mo><mn>3</mn><mfrac><msubsup><mover><mi>Ïƒ</mi><mo accent="true">Ì‚</mo></mover><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>2</mn></msubsup><msubsup><mi>Ïƒ</mi><mrow><mi>m</mi><mo>âˆ£</mo><mi>g</mi></mrow><mn>4</mn></msubsup></mfrac><mo minsize="3.0" maxsize="3.0" stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">
\frac{\partial^2 \lambda_3}{\partial \sigma_{m \mid g} \partial \sigma_{m \mid g}} \;=\; \sum_g^K \frac{\alpha}{K} \Bigg(\frac{1}{\sigma_{m \mid g}} - 3\frac{\hat{\sigma}^2_{m \mid g}}{\sigma^4_{m \mid g}}\Bigg).
</annotation></semantics></math></p>
</section></section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marcos JimÃ©nez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  
</body>
</html>
